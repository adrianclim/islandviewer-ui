{% extends "base.html" %}
{% load static %} 

{% block headextras %}
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="{% static 'js/d3-tip.js' %}"></script>
    <link href="{% static 'js/chosen/chosen.min.css' %}" rel="stylesheet">
    <script src="{% static 'js/chosen/chosen.jquery.min.js' %}"></script>
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>

{% endblock %}

{% block sidebar %}
{% if not noanalysis %}
  {% if status == "Complete" %}
    {% include "resultssidebar.html" %}
  {% else %}
  &nbsp;<br />
  <span class="smalltext">
  The analysis is not yet complete, please check back to this page
  in a while, or you will be notified by email when the analysis if you elected
  to enter an email address.<br />
  &nbsp;<br />
  The graph to the right will show you the status of the Islandviewer pipeline.<br />
  &nbsp;<br />
  </span>
  <span class="headertext">Legend:</span><br />
  <span class="smalltext">&nbsp;<br />
    &nbsp;&nbsp;<span class="legend Pending">&nbsp;</span>&nbsp;&nbsp;Pending<br />
    &nbsp;&nbsp;<span class="legend Running">&nbsp;</span>&nbsp;&nbsp;Running<br />
    &nbsp;&nbsp;<span class="legend Complete">&nbsp;</span>&nbsp;&nbsp;Complete<br />
    &nbsp;&nbsp;<span class="legend Error">&nbsp;</span>&nbsp;&nbsp;Error<br />
  </span>
  {% endif %}
{% endif %}
{% endblock %}

{% block content %}
{% if noanalysis %}
    {% include "noanalysis.html" %}
{% else %}
  {% if status == "Complete" %}

    <script src="{% static 'js/islandviewer.js' %}"></script>
    <script src="{% static 'js/circularplot.js' %}"></script>
    <script src="{% static 'js/linearplot.js' %}"></script>
    <script src="{% static 'js/canvg.js' %}"></script>
    <script src="{% static 'js/FileSaver/FileSaver.js' %}"></script>
    <script src="{% static 'js/jquery.dataTables.js' %}"></script>
    <span class="pageName">{{ genomename }}</span>
    <div id="circularchart"><img id="loadingimg" class="loadingimg" src="{% static 'img/loading.gif' %}"></div>
    <div id="gene_dialog"></div>
	<div id="circularchartlinearwrapper" class="linear_hidden"><img id="circularchartlinearclose" width="20" height="20" src="{% static 'img/close.svg' %}"><div id="circularchartlinear"></div></div>
    <div id="geneslist" class="hidden"><img id="genelistclose" width="20" height="20" src="{% static 'img/close.svg' %}">
    <span id="geneslistnothing" class="hidden">Sorry, no genes were found in this island.</span>
    <span id="geneslistvalues" class="hidden"><table id="geneslisttable" class="gitable table table-condensed idb-table" style="font-size: 90%">
	<thead>
      <tr>
        <td>Coordinates</td><td>Name</td><td>Gene</td><td>Locus</td><td>Product</td>
      </tr>
    </thead>
    </table></span>
    </div>

    <div class="hidden"><button id="save_as_png" value="">
			Save as High-Res PNG</button></div>
    <script src="/islandviewer/plot/{{ aid }}"></script>
	&nbsp;<br />
    {% include "results.download.html" %}
    {% include "gitable.html" %}

  {% else %}
   <div class="pageName">{{ genomename }}</div>
  
   <script src="{% static 'js/dagre-d3.min.js' %}"></script>
  
   <svg id="pipelinegraph" width=500 height=600>
   <g transform="translate(20, 20)"/>
   </svg>

   <script src="{% url 'graphanalysisjs' aid %}"></script>
  
  {% endif %}
{% endif %}
{% endblock content %}
